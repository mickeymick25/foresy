ğŸ¢ FEATURE CONTRACT 08 â€” ACTIVITÃ‰ & CADRE ENTREPRISE

Configuration de lâ€™Entreprise, des Ã‰tablissements et des ActivitÃ©s

âš ï¸ DOCUMENT CONTRACTUEL â€” SOURCE DE VÃ‰RITÃ‰
âš ï¸ Toute ambiguÃ¯tÃ© DOIT Ãªtre signalÃ©e avant implÃ©mentation
âš ï¸ Aucune dÃ©viation autorisÃ©e

1ï¸âƒ£ Feature Name

Enterprise & Activity Configuration (FC08)

2ï¸âƒ£ Business Goal

Permettre Ã  un IndÃ©pendant de :

rattacher son compte Ã  une SociÃ©tÃ© existante

rÃ©cupÃ©rer automatiquement les donnÃ©es lÃ©gales officielles (INSEE)

dÃ©clarer les ActivitÃ©s rÃ©ellement exercÃ©es

associer Ã  chaque ActivitÃ© un cadre fiscal dÃ©claratif

fournir le socle structurel nÃ©cessaire Ã  :

la lecture correcte des CRA (FC07)

la facturation future

les simulations fiscales (hors MVP)

ğŸ‘‰ FC08 ne calcule rien
ğŸ‘‰ FC08 ne valide rien fiscalement
ğŸ‘‰ FC08 dÃ©crit le cadre, sans se substituer Ã  un expert-comptable

3ï¸âƒ£ Actors
Primary Actor

Authenticated User (JWT)

PrÃ©-requis mÃ©tier

Lâ€™utilisateur a le rÃ´le independent

Un utilisateur peut :

soit disposer dâ€™une sociÃ©tÃ© existante

soit ne pas encore avoir dâ€™entreprise (cas simulation, hors MVP)

âš ï¸ MVP : prioritÃ© donnÃ©e aux utilisateurs avec sociÃ©tÃ© existante

4ï¸âƒ£ Domain Boundaries (INVARIANTS DDD â€” NON NÃ‰GOCIABLES)
Domaine	ResponsabilitÃ©
SociÃ©tÃ©	Existence juridique
Ã‰tablissement	Localisation dâ€™exercice
ActivitÃ©	MÃ©tier exercÃ©
RÃ©gimeFiscal	Cadre fiscal applicable Ã  UNE activitÃ©

âŒ Aucune logique fiscale dans SociÃ©tÃ©
âŒ Aucune TVA dans CRA
âŒ Aucune rÃ¨gle mÃ©tier transverse entre domaines

5ï¸âƒ£ Architectural Principles (STRICT)

ğŸ§± Domain-Driven & Relation-Driven

âŒ Aucun FK mÃ©tier dans les Domain Models
âœ… Relations explicites via Relation Models
âœ… AuditabilitÃ© totale
âœ… Versionnable
âœ… DÃ©terminisme absolu

6ï¸âƒ£ Domain Models (PURS)
ğŸ¢ Company (SociÃ©tÃ©)
Champ	Type	Required	Notes
id	UUID	Yes
siren	String	Yes	INSEE
legal_name	String	Yes
legal_form	String	Yes
status	Enum	Yes	A | C
created_at	DateTime	Yes
updated_at	DateTime	Yes

âš ï¸ Aucun rÃ©gime fiscal
âš ï¸ Aucun calcul

ğŸ¬ Establishment (Ã‰tablissement)
Champ	Type	Required	Notes
id	UUID	Yes
siret	String	Yes
is_head_office	Boolean	Yes
address	JSON	Yes
created_at	DateTime	Yes
updated_at	DateTime	Yes
ğŸ§‘â€ğŸ’¼ Activity (ActivitÃ©)
Champ	Type	Required	Notes
id	UUID	Yes
naf_code	String	Yes
label	String	Yes
is_primary	Boolean	Yes
regulated_profession	Boolean	Yes	Informatif uniquement
created_at	DateTime	Yes
updated_at	DateTime	Yes

âš ï¸ Aucun rÃ©gime fiscal ici
âš ï¸ Aucune TVA

ğŸ’° FiscalRegime (attachÃ© Ã  Activity)
Champ	Type	Required	Notes
id	UUID	Yes
income_tax_type	Enum	Yes	IR | IS
vat_regime	Enum	Yes	franchise | rÃ©el
declaration_mode	Enum	No	contrÃ´lÃ©e / micro
valid_from	Date	Yes
valid_to	Date	No
tax_profile	JSON	No	RÃ©servÃ© futur
created_at	DateTime	Yes

âš ï¸ DÃ©claratif
âš ï¸ Aucun calcul
âš ï¸ Peut Ã©voluer dans le temps

7ï¸âƒ£ Relation Models (OBLIGATOIRES)
CompanyEstablishment

(company â†” establishment)

EstablishmentActivity

(establishment â†” activity)

ActivityFiscalRegime

(activity â†” fiscal_regime)

ğŸ”’ Contraintes :

Une activitÃ© peut avoir plusieurs rÃ©gimes dans le temps

Un seul rÃ©gime actif Ã  un instant T

8ï¸âƒ£ IntÃ©gration INSEE (MVP)

Input : SIREN ou SIRET

API officielle INSEE

Snapshot Ã  la crÃ©ation

VÃ©rification mensuelle du statut (A / C)

âŒ Pas de synchronisation temps rÃ©el
âŒ Pas dâ€™Ã©dition manuelle des donnÃ©es INSEE

9ï¸âƒ£ Ce que FC08 NE FAIT PAS (IMPORTANT)

âŒ Ne dÃ©termine pas si une activitÃ© est rÃ©glementÃ©e
âŒ Ne bloque pas une activitÃ© rÃ©glementÃ©e
âŒ Ne calcule ni TVA ni impÃ´t
âŒ Ne valide pas un rÃ©gime fiscal
âŒ Ne remplace pas un comptable

ğŸ‘‰ FC08 dÃ©crit, il ne juge pas.

ğŸ”Ÿ API Scope
SociÃ©tÃ©

POST /api/v1/company/link

GET /api/v1/company

Ã‰tablissements

GET /api/v1/establishments

ActivitÃ©s

POST /api/v1/activities

GET /api/v1/activities

RÃ©gime fiscal

POST /api/v1/activities/:id/fiscal_regimes

GET /api/v1/activities/:id/fiscal_regimes

1ï¸âƒ£1ï¸âƒ£ Errors
Status	Code
401	unauthorized
403	forbidden
404	not_found
409	invalid_relation
422	invalid_payload
500	insee_unavailable
1ï¸âƒ£2ï¸âƒ£ Acceptance Criteria (Gherkin)
Scenario: Attach an activity with a fiscal regime
  Given I am authenticated as independent
  And my company is linked via INSEE
  When I declare an activity
  And I attach a fiscal regime
  Then the activity is usable in CRA

1ï¸âƒ£3ï¸âƒ£ Definition of Done

Domain specs verts

Relations auditables

INSEE snapshot OK

Swagger documentÃ©

Aucun calcul fiscal

FC07 compatible

ğŸ§  Invariants DDD (Ã€ NE JAMAIS VIOLER)

1ï¸âƒ£ Le rÃ©gime fiscal appartient Ã  lâ€™ActivitÃ©
2ï¸âƒ£ Le CRA ne connaÃ®t pas la fiscalitÃ©
3ï¸âƒ£ SociÃ©tÃ© â‰  FiscalitÃ©
4ï¸âƒ£ Toute relation est explicite
5ï¸âƒ£ Aucune â€œintelligence comptableâ€ dans le backend

âœ… Ã‰TAT FINAL
Axe	Statut
ModÃ©lisation	ğŸŸ¢ VerrouillÃ©e
SÃ©paration des domaines	ğŸŸ¢ Exemplaire
ExtensibilitÃ©	ğŸŸ¢ Long terme
CompatibilitÃ© FC07	ğŸŸ¢ Totale
Vision produit	ğŸŸ¢ Claire
